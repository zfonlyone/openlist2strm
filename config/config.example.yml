# OpenList2STRM 配置文件 (v1.1.0)

# ==============================================================================
# OpenList 配置
# ==============================================================================
openlist:
  # OpenList 访问地址
  host: http://openlist:5244
  # OpenList API Token (在 OpenList 管理后台获取)
  token: your-openlist-token
  # 请求超时时间 (秒)
  timeout: 30

# ==============================================================================
# 路径配置
# ==============================================================================
paths:
  # 源路径 (OpenList 中需要监控的路径)
  source:
    - /115/流媒体
    - /115/电影
    - /115/电视剧
    - /115/动漫
    - /115/综艺
  # STRM 文件输出路径
  output: /strm

# 路径映射配置
# 将 OpenList 路径转换为 STRM 文件中的 URL
path_mapping:
  /115: http://openlist:5244/d/115

# ==============================================================================
# STRM 生成配置 (v1.1.0 增强)
# ==============================================================================
strm:
  # 支持的视频文件扩展名
  extensions:
    - .mp4
    - .mkv
    - .avi
    - .ts
    - .wmv
    - .rmvb
    - .mov
    - .flv
    - .m2ts
    - .webm
  # 是否保持源目录结构
  keep_structure: true
  # 是否对 URL 进行编码
  url_encode: true
  # STRM 生成模式 (v1.1.0 新增)
  # - path: 使用相对路径 (适合本地 WebDAV 挂载)
  # - direct_link: 使用完整 URL 直链 (适合远程访问)
  mode: path
  # STRM 文件本地保存路径 (v1.1.0 新增)
  output_path: /strm

# ==============================================================================
# 扫描模式配置 (v1.1.0 新增)
# ==============================================================================
scan:
  # 扫描模式
  # - incremental: 增量更新 - 仅处理新增/修改的文件
  # - full: 全量扫描 - 重新处理所有文件
  mode: incremental
  # 数据源
  # - cache: 读取缓存 - 使用本地缓存的文件列表 (更快)
  # - realtime: 实时读取 - 每次从网盘获取最新数据 (更准确)
  data_source: cache

# ==============================================================================
# QoS 限流配置 (v1.1.0 增强)
# ==============================================================================
qos:
  # 每秒请求数限制
  qps: 5
  # 最大并发请求数
  max_concurrent: 3
  # 请求间隔 (毫秒)
  interval: 200
  # 线程模式 (v1.1.0 新增)
  # - single: 单线程模式
  # - multi: 多线程模式
  threading_mode: multi
  # 线程池大小 (多线程模式) (v1.1.0 新增)
  thread_pool_size: 4
  # 每分钟请求限制 (v1.1.0 新增)
  rate_limit: 100

# ==============================================================================
# 定时任务配置 (v1.1.0 增强 - 多任务支持)
# ==============================================================================
schedule:
  # 是否启用定时任务
  enabled: false
  # 启动时是否立即执行一次
  on_startup: false
  # 多任务列表 (v1.1.0 新增)
  # 支持创建多个独立的定时任务
  tasks:
    # 示例任务 1: 电影扫描
    - id: task_movies
      name: "电影扫描"
      folder: /115/电影
      cron: "0 2 * * *"      # 每天凌晨 2 点
      enabled: true
      one_time: false        # false=循环, true=一次性
    # 示例任务 2: 电视剧扫描
    - id: task_tv
      name: "电视剧扫描"
      folder: /115/电视剧
      cron: "0 3 * * *"      # 每天凌晨 3 点
      enabled: true
      one_time: false

# Cron 表达式示例:
#   */30 * * * * - 每 30 分钟
#   0 * * * *    - 每小时整点
#   0 2 * * *    - 每天凌晨 2 点
#   0 2 * * 0    - 每周日凌晨 2 点
#   0 2 1 * *    - 每月 1 号凌晨 2 点
# 格式: 分 时 日 月 周

# ==============================================================================
# 增量更新配置
# ==============================================================================
incremental:
  # 是否启用增量更新
  enabled: true
  # 检测方式: mtime (修改时间) | size (文件大小) | both (两者都检测)
  check_method: mtime

# ==============================================================================
# Emby 通知配置 (v1.1.0 新增)
# ==============================================================================
# 扫描完成后自动通知 Emby 刷新媒体库
emby:
  # 是否启用 Emby 通知
  enabled: false
  # Emby 服务器地址
  host: http://emby:8096
  # Emby API Key
  # 获取方式: Emby 设置 → 高级 → API 密钥 → 新建应用程序
  api_key: your-emby-api-key
  # 指定媒体库 ID (留空扫描所有媒体库)
  library_id: ""
  # 扫描完成后自动刷新
  notify_on_scan: true

# ==============================================================================
# Telegram 机器人配置
# ==============================================================================
telegram:
  # 是否启用 Telegram 机器人
  enabled: false
  # 机器人 Token (从 @BotFather 获取)
  token: your-telegram-bot-token
  # 用户/群组 ID (用于接收通知) (v1.1.0 新增)
  chat_id: ""
  # 允许使用的用户 ID 列表 (留空允许所有用户)
  allowed_users: []
  # 通知设置
  notify:
    # 扫描开始时通知
    on_scan_start: true
    # 扫描完成时通知
    on_scan_complete: true
    # 发生错误时通知
    on_error: true

# ==============================================================================
# Web 管理界面配置
# ==============================================================================
web:
  # 是否启用 Web 界面
  enabled: true
  # 监听端口
  port: 9527
  # 认证配置
  auth:
    # 是否启用认证 (强烈建议启用)
    enabled: true
    # 管理员用户名
    username: admin
    # 管理员密码 (首次运行时通过 deploy.sh 设置)
    password: ""
    # API Token (用于程序化访问，可通过 Web 界面生成)
    api_token: ""

# ==============================================================================
# 日志配置
# ==============================================================================
logging:
  # 日志级别: DEBUG | INFO | WARNING | ERROR
  level: INFO
  # 日志保留天数
  retention_days: 7
  # 是否输出彩色日志
  colorize: true
